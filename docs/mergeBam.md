# mergeBam

The ScaleMethyl workflow offers an option to start the workflow using BAM files that have been generated by two separate ScaleMethyl runs. It is useful when combining multiple Illumina S4 runs. The mergeBam process combines bam files produced by [BSBolt](https://github.com/NuttyLogic/BSBolt) from two previous ScaleMethyl runs into bam files containing all reads for a given `<sample>.<tn5>` along with their alignments. Prior to merging the bam files, read group (@RG) annotation tags (for ID and LB) are assigned for each read in the bam files to be merged. The merge operation is performed using [samtools merge](http://www.htslib.org/doc/samtools-merge.html#EXAMPLES)

## Inputs
For starting from BAM files the workflow requires as input two separate directories of bam files.  
* `bam1Dir : "path/to/outDir_run1/alignment"`  
* `bam2Dir : "path/to/outDir_run2/alignment"`  
* `samples.csv : "path/to/samples.csv` sample and barcodes should be the same used on the first two runs  

If `splitFastq` is set to `false`, the workflow expects the BAM files to NOT be split by TN5 barcode, so they should follow the naming convention "{sample name}.bam" If `splitFastq` is set to `true`, the input BAM files should be split by TN5 barcode and should be named as "{sample name}.{tn5 barcode well coordinate}.bam" in the sample alignment directory format. 

## Outputs
By default, the merged bam files are not published in the workflow output.  If `bamMergeOut` is set to `true`, merged bam files will be saved to the `bamMerge` folder in the output directory.

