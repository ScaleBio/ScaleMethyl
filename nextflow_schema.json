{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://raw.githubusercontent.com/ScaleBio/ScaleAtac/master/nextflow_schema.json",
    "title": "ScaleBio Methylation pipeline parameters",
    "description": "See Readme.md for further documentation.",
    "type": "object",
    "definitions": {
        "help_options":{
            "title":"Help options",
            "type":"object",
            "fa_icon": "fas fa-terminal",
            "properties": {
                "help": {
                    "type":"boolean",
                    "description":"Print params description to console?",
                    "hidden":true
                },
                "show_hidden_params":{
                    "type":"boolean",
                    "description":"Show parameters marked as hidden when invoking --help?",
                    "hidden":true
                }
            }
        },
        "input_options": {
            "title": "Input options",
            "type": "object",
            "fa_icon": "fas fa-terminal",
            "description": "Define analysis input data.",
            "properties": {
                "samples": {
                    "type": "string",
                    "format": "file-path",
                    "mimetype": "text/csv",
                    "pattern": "^\\S+\\.csv$",
                    "description": "Csv file describing all samples in the analysis run (required!)",
                    "fa_icon": "fas fa-file-csv"
                },
                "fastqSamplesheet": {
                  "type": "string",
                  "format": "file-path",
                  "mimetype": "text/csv",
                  "pattern": "^\\S+\\.csv$",
                  "description": "Csv file for bcl-convert",
                  "fa_icon": "fas fa-file-csv"
                },
                "runFolder": {
                    "type": "string",
                    "description": "Top-level sequencer run directory (or null when using fastq input)",
                    "format": "directory-path"
                },
                "fastqDir": {
                    "type": "string",
                    "description":"Directory containing pre-generated FASTQs files (or null when using runFolder input)",
                    "format": "directory-path"
                }
            },
            "required": [
                "samples"
            ]
        },
        "output_options": {
            "title": "Output paths and options",
            "type": "object",
            "fa_icon": "fas fa-terminal",
            "properties": {
                "outDir": {
                    "type": "string",
                    "description": "Name of the output directory for workflow results",
                    "format": "directory-path"
                }
            },
            "required": [
                "outDir"
            ]
        },
        "reference_genome_options": {
            "title": "Reference genome options",
            "type": "object",
            "fa_icon": "fas fa-dna",
            "description": "Reference genome related files and options required for the workflow.",
            "properties": {
                "genome": {
                    "type": "string",
                    "description": "json file with paths and parameters for the reference genome (required!)",
                    "format": "file-path",
                    "mimetype": "text/json",
                    "pattern": "^\\S+\\.json$"
                }
            }
        },
        "analysis_options": {
            "title": "Analysis options",
            "type": "object",
            "fa_icon": "fas fa-sliders-h",
            "description": "Configure analysis steps and options",
            "properties": {
                "libStructure": {
                    "type": "string",
                    "format": "file-path",
                    "mimetype": "text/json",
                    "pattern": "^\\S+\\.json$",
                    "description": "Json file describing library structure and index/barcode sequences",
                    "fa_icon": "fas fa-file-json"
                },
                "fastqOut": {
                    "type": "boolean",
                    "description": "Publish fastq files generated by bcl convert and bcParser to output directory"
                },
                "splitFastq": {
                    "type": "boolean",
                    "description": "Enable i5 or i7 splitting for the purpose of bcl conversion"
                },
                "bclConvertParams": {
                    "type": "string",
                    "description": "Extra parameters to be supplied to bcl-convert"
                },
                "covOut": {
                    "type": "boolean",
                    "description": "Publish methylation extraction cov files"
                },
                "allcOut": {
                    "type": "boolean",
                    "description": "Publish ALLC files for analysis with ALLCools"
                },
                "amethystOut": {
                    "type": "boolean",
                    "description": "Publish hdf5 cov files for analysis with Amethyst"
                },
                "bamOut": {
                    "type": "boolean",
                    "description": "Publish bam files for all reads"
                },
                "bamDedupOut": {
                    "type": "boolean",
                    "description": "Publish deduplicated bam files"
                },
                "minUniqTotal": {
                    "type": "integer",
                    "description": "Filter for minimum unique/total reads by barcode"
                },
                "maxUniqTotal": {
                    "type": "integer",
                    "description": "Filter for maximum unique/total reads by barcode"
                }
            }
        },
        "reporting_only_options": {
            "title": "Rerun reporting only options",
            "type": "object",
            "fa_icon": "fas fa-sliders-h",
            "description": "Provide options for running only reporting(samples csv to be provided in Input Options block)",
            "properties": {
                "reporting": {
                    "type": "boolean",
                    "description": "Enable to rerun only reporting(fastqDir or runFolder not required)"
                },
                "resultDir": {
                    "type": "string",
                    "description": "Output directory of previous run for which you want to rerun reporting",
                    "format": "directory-path"
                }
            }
        }

    },
    "allOf": [
        {
            "$ref": "#/definitions/help_options"
        },
        {
            "$ref": "#/definitions/input_options"
        },
        {
            "$ref": "#/definitions/output_options"
        },
        {
            "$ref": "#/definitions/reference_genome_options"
        },
        {
            "$ref": "#/definitions/analysis_options"
        },
        {
            "$ref": "#/definitions/reporting_only_options"
        }
    ]
}
